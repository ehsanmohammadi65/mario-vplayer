(function(e,c){typeof exports=="object"&&typeof module<"u"?module.exports=c(require("vue")):typeof define=="function"&&define.amd?define(["vue"],c):(e=typeof globalThis<"u"?globalThis:e||self,e.MarioVPlayer=c(e.Vue))})(this,function(e){"use strict";const c={class:"text-overlay",dir:"ltr"},w=["src"],M={class:"text-white text-sm",dir:"ltr"},P=["value"];return{__name:"MarioVPlayer",props:{code:{type:String},video:{type:String,required:!0},w:{type:String},h:{type:String}},setup(B){const v=B,t=e.ref(null),a=e.ref(null),r=e.ref(!1),n=e.ref(!1),p=e.ref("0:00"),h=e.ref("0:00"),f=e.ref(!0),g=e.ref(0),s=e.ref(!1),d=e.ref(!1),y=e.ref(null);let m=null,T=0,k=0;const F=()=>{s.value=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)};e.watch(()=>v.video,async l=>{if(l)try{if(r.value=!1,p.value="0:00",h.value="0:00",g.value=0,await e.nextTick(),t.value){t.value.pause(),t.value.currentTime=0,t.value.src=l,t.value.load();try{await t.value.play(),r.value=!0}catch(o){console.log("Autoplay blocked:",o),r.value=!1}}}catch(o){console.error("Error changing video:",o)}},{immediate:!0});const X=()=>{if(!d.value&&t.value&&!isNaN(t.value.duration)){const l=t.value.currentTime/t.value.duration*100;g.value=l,p.value=L(t.value.currentTime)}},_=()=>{t.value&&!isNaN(t.value.duration)&&(h.value=L(t.value.duration))},C=()=>{r.value?(t.value.pause(),r.value=!1):t.value.play().then(()=>{r.value=!0}).catch(l=>{console.error("Play failed:",l)}),i()},D=()=>{document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():a.value.requestFullscreen&&a.value.requestFullscreen().catch(l=>{console.error(`Error attempting to enable fullscreen: ${l.message}`)})},S=()=>{n.value=!!document.fullscreenElement,n.value?i():(f.value=!0,clearTimeout(m))},i=()=>{f.value=!0,I()},b=()=>{n.value&&r.value&&(f.value=!1)},I=()=>{clearTimeout(m),n.value&&r.value&&(m=setTimeout(b,3e3))},N=l=>{!s.value||!n.value||(T=l.touches[0].clientX,k=t.value.currentTime,d.value=!0)},V=l=>{if(!s.value||!n.value||!d.value)return;const E=(l.touches[0].clientX-T)/window.innerWidth*10;t.value.currentTime=Math.max(0,Math.min(k+E,t.value.duration)),i()},x=()=>{!s.value||!d.value||(d.value=!1,clearTimeout(y.value),y.value=setTimeout(()=>{r.value&&b()},3e3))},q=l=>{if(!t.value)return;const u=l.target.getBoundingClientRect(),E=l.clientX-u.left,z=u.width,A=E/z*t.value.duration;t.value.currentTime=A,i()},L=l=>{const o=Math.floor(l/60),u=Math.floor(l%60);return`${o}:${u<10?"0":""}${u}`};return e.onMounted(()=>{F(),t.value.addEventListener("timeupdate",X),t.value.addEventListener("loadedmetadata",_),t.value.addEventListener("durationchange",_),document.addEventListener("fullscreenchange",S),s.value?(a.value.addEventListener("touchstart",N,{passive:!0}),a.value.addEventListener("touchmove",V,{passive:!0}),a.value.addEventListener("touchend",x,{passive:!0})):a.value.addEventListener("mousemove",i)}),e.onUnmounted(()=>{document.removeEventListener("fullscreenchange",S),s.value?(a.value.removeEventListener("touchstart",N),a.value.removeEventListener("touchmove",V),a.value.removeEventListener("touchend",x)):a.value.removeEventListener("mousemove",i),clearTimeout(m),clearTimeout(y.value)}),(l,o)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass([[n.value?"fullscreen-video":"",v.w],"video-player-container"]),ref_key:"videoContainer",ref:a},[e.createElementVNode("div",c,e.toDisplayString(v.code),1),e.createElementVNode("video",{ref_key:"controls",ref:t,controls:!1,onClick:C,playsinline:"","webkit-playsinline":"","x5-playsinline":""},[e.createElementVNode("source",{src:v.video,type:"video/mp4"},null,8,w)],512),e.createElementVNode("div",{class:e.normalizeClass(["controls-container",[n.value?"fullscreen-controls":"",n.value&&!f.value?"hidden":""]])},[e.createElementVNode("div",{class:e.normalizeClass(["progress-bar",n.value?"fullscreen-progress":""])},[e.createElementVNode("span",M,e.toDisplayString(p.value)+" / "+e.toDisplayString(h.value),1),e.createElementVNode("progress",{dir:"ltr",id:"progress",value:g.value,max:"100",onClick:q},null,8,P)],2),e.createElementVNode("div",{class:e.normalizeClass(["buttons-bar",n.value?"fullscreen-buttons":""]),dir:"ltr"},[e.createElementVNode("button",{onClick:C},e.toDisplayString(r.value?"⏸ Pause":"▶️ Play"),1),e.createElementVNode("button",{onClick:D},e.toDisplayString(n.value?"⛶ Exit":"⛶ Fullscreen"),1)],2)],2)],2))}}});
